# Autonomous Affiliate Funnel (AAF-01) - Project Log & Operating Manual

**Last Updated:** 2025-07-09
**Project Status:** Phase 2 - Awaiting Manual Link Generation
**Mission:** Design, build, and deploy a fully autonomous, AI-driven affiliate content engine with integrated video automation.

---

## 1. Table of Contents

- **1. Strategic Directives**
  - 1.1. Core Mission & Guiding Principles
  - 1.2. Selected Niche & Affiliate Strategy
- **2. System Architecture**
  - 2.1. High-Level Workflow
  - 2.2. Technology Stack & Credential Management
- **3. Standard Operating Procedures (SOPs)**
  - 3.1. SOP-01: Initial Project Setup (For New Environments)
  - 3.2. SOP-02: Seeding the Database with Product Opportunities
  - 3.3. SOP-03: Generating & Registering Affiliate Links
  - 3.4. SOP-04: Generating Content for an Active Product
  - 3.5. SOP-05: Viewing the Live Development Site
- **4. Phase-Based Execution Plan**
  - 4.1. Phase 1: Infrastructure & Niche Selection (Complete)
  - 4.2. Phase 2: Content Engine Development (In Progress)
  - 4.3. Future Phases (Video, Monitoring, Optimization)
- **5. Asset & Documentation Index**
  - 5.1. Core Project Scripts
  - 5.2. Key Data & Configuration Files
  - 5.3. External API Documentation
- **6. Actionable Changelog**

---

## 2. Strategic Directives

### 2.1. Core Mission & Guiding Principles
- **Mission:** To build an autonomous marketing agent that identifies profitable opportunities, generates high-value, multi-format content (text and video), and continuously optimizes its own performance to maximize affiliate revenue.
- **Principles:** AI-First Content, Full-Cycle Automation, Data-Driven Evolution, Multi-Format Dominance.

### 2.2. Selected Niche & Affiliate Strategy
- **Domain:** AI, LLMs, and Chatbot Technologies.
- **Primary Affiliate Network:** Amazon Associates (`Tracking ID: 33377701-20`).
- **Interim Strategy:** Due to a 3-sale qualification period for API access, the system will initially operate with a **manual link generation workflow**. The agent identifies opportunities, and the user generates the links via SiteStripe. Full API automation is a post-qualification goal.

---

## 3. System Architecture

### 3.1. High-Level Workflow
`[Manual Product Seeding] -> [SQLite DB] -> [Python ContentAgent] -> [LLM APIs] -> [Generated .md Article] -> [Hugo Engine] -> [Live Website]`

### 3.2. Technology Stack & Credential Management
- **Core:** Python 3.11+, Hugo, SQLite.
- **APIs:** OpenAI (Content), ElevenLabs (Voice), Pexels (Images), Shotstack (Video).
- **Credentials:** All API keys are managed in the `.env` file, which is excluded from version control.

---

## 4. Standard Operating Procedures (SOPs)

This section serves as the official user guide for operating the AAF system in its current state.

### 4.1. SOP-01: Initial Project Setup (For New Environments)
1.  **Clone the repository:** `git clone <repository_url>`
2.  **Navigate to the directory:** `cd ai-affiliate-funnel`
3.  **Create the Python virtual environment:** `python3 -m venv .venv`
4.  **Activate the environment:** `source .venv/bin/activate`
5.  **Install dependencies:** `pip install -r requirements.txt`
6.  **Configure API Keys:** Copy the example environment file `cp .env.example .env` and populate `.env` with your secret keys.

### 4.2. SOP-02: Seeding the Database with Product Opportunities
- **Purpose:** To populate the system's database with a curated list of high-value products.
- **Command:**
  ```bash
  source .venv/bin/activate && python seed_products_database.py
  ```
- **Outcome:** The `amazon_intelligence.db` file will be created/updated, and a new `affiliate_instructions_*.txt` file will be generated with a prioritized list of products needing affiliate links.

### 4.3. SOP-03: Generating & Registering Affiliate Links
This is the primary manual task required to make products "live" for content generation.
1.  **Identify Products:** Open the latest `affiliate_instructions_*.txt` file generated by the seeder script.
2.  **Generate Links via SiteStripe:**
    - Log into your Amazon Associates account.
    - For each product URL in the instruction file, navigate to the page.
    - Use the SiteStripe toolbar at the top of the page to **Get Link -> Text** and copy the `amzn.to` short link.
3.  **Register the Link in the Database:** For each link you generate, use the new utility script to update the database.
    - **Command:**
      ```bash
      source .venv/bin/activate && python update_affiliate_link.py <PRODUCT_ASIN> "<AFFILIATE_LINK>"
      ```
    - **Example:**
      ```bash
      source .venv/bin/activate && python update_affiliate_link.py B08B3FZRBC "amzn.to/123xyz"
      ```
    - **Outcome:** The script will update the product's record in the database, setting its status to `ACTIVE`.

### 4.4. SOP-04: Generating Content for an Active Product
- **Purpose:** To use the AI agent to write and publish a new article for a product that has an active affiliate link.
- **Command:**
  ```bash
  source .venv/bin/activate && python generate_article.py "<Article Title>" "<hugo-filename>"
  ```
- **Example:**
  ```bash
  source .venv/bin/activate && python generate_article.py "A Deep Dive into Hands-On Machine Learning" "hands-on-machine-learning-review"
  ```
- **Outcome:** A new Markdown file will be created in the `content/posts/` directory, ready to be viewed on the local server.

### 4.5. SOP-05: Viewing the Live Development Site
- **Purpose:** To run a local web server to preview the generated site and content.
- **Command:**
  ```bash
  hugo server &> hugo.log &
  ```
- **Access:** The live site can be viewed at `http://localhost:1313/`.
- **Logs:** You can monitor the server's activity in real-time with `tail -f hugo.log`.

---

## 5. Phase-Based Execution Plan
*(This section remains largely unchanged but is now contextualized by the SOPs above)*

- **Phase 1: Complete.**
- **Phase 2: In Progress.** The core scripts (`seed_products_database.py`, `update_affiliate_link.py`, `generate_article.py`) are built. The next step is to follow the SOPs to generate the first monetized articles.
- **Future Phases:** Video Engine, Monitoring Loop, and Cython Optimization remain pending.

---

## 6. Asset & Documentation Index

### 6.1. Core Project Scripts
| Script | Purpose |
|---|---|
| `seed_products_database.py` | Populates the DB with high-value products. |
| `update_affiliate_link.py`| **NEW:** Updates a product with its affiliate link, activating it. |
| `generate_article.py` | Generates a Hugo article for a given topic. |

### 6.2. Key Data & Configuration Files
| File | Purpose |
|---|---|
| `amazon_intelligence.db` | SQLite database for all product opportunity data. |
| `affiliate_instructions_*.txt` | Auto-generated file with steps for manual link creation. |
| `.env` | Secure storage for all API keys. |
| `hugo.toml` | Main Hugo site configuration. |

---

## 7. Actionable Changelog

- **2025-07-09 (Session 3):**
  - **Action:** Created `update_affiliate_link.py` utility to provide a robust, user-friendly method for updating the product database with affiliate links.
  - **Action:** Completely restructured and rewrote the project log to serve as a comprehensive Operating Manual, including a new "Standard Operating Procedures (SOPs)" section.
- **(Previous session entries remain unchanged)**
